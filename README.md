# Численное вычисление квадратурных форм

**Цель:** высчитать интеграл $erf(x)=\int\limits_{0}^{x}e^{-t^{2}}dt$ 
при помощи квадратурных форм

## Сравнение популярных способов

### Метод левых прямоугольников:

| $x$    | $J_0(x)$    | $J_n(x)$    | $n$       |
|:------:|:----------:|:----------:|:----------|
|$0.00$ | $0.000000$ | $0.000000$ | $1       $|
|$0.20$ | $0.222703$ | $0.222703$ | $8192    $|
|$0.40$ | $0.428392$ | $0.428393$ | $65536   $|
|$0.60$ | $0.603856$ | $0.603857$ | $131072  $|
|$0.80$ | $0.742101$ | $0.742102$ | $262144  $|
|$1.00$ | $0.842701$ | $0.842701$ | $524288  $|
|$1.20$ | $0.910314$ | $0.910315$ | $524288  $|
|$1.40$ | $0.952285$ | $0.952286$ | $1048576 $|
|$1.60$ | $0.976348$ | $0.976349$ | $1048576 $|
|$1.80$ | $0.989091$ | $0.989091$ | $1048576 $|
|$2.00$ | $0.995322$ | $0.995323$ | $1048576 $|

$\boxed{n_{max}=1'048'576}$

---

### Метод правых прямоугольников:

| $x$    | $J_0(x)$    | $J_n(x)$    | $n$       |
|:------:|:----------:|:----------:|:----------|
|$0.00$ | $0.000000$ | $0.000000$ | $1       $|
|$0.20$ | $0.222703$ | $0.222703$ | $8192    $|
|$0.40$ | $0.428392$ | $0.428393$ | $65536   $|
|$0.60$ | $0.603856$ | $0.603857$ | $131072  $|
|$0.80$ | $0.742101$ | $0.742102$ | $262144  $|
|$1.00$ | $0.842701$ | $0.842701$ | $524288  $|
|$1.20$ | $0.910314$ | $0.910315$ | $524288  $|
|$1.40$ | $0.952285$ | $0.952286$ | $1048576 $|
|$1.60$ | $0.976348$ | $0.976349$ | $1048576 $|
|$1.80$ | $0.989091$ | $0.989091$ | $1048576 $|
|$2.00$ | $0.995322$ | $0.995323$ | $1048576 $|

$\boxed{n_{max}=1'048'576}$

---

### Метод центральных прямоугольников:

| $x$    | $J_0(x)$    | $J_n(x)$    | $n$       |
|:------:|:----------:|:----------:|:----------|
|$0.00$ | $0.000000$ | $0.000000$ | $1       $|
|$0.20$ | $0.222703$ | $0.222703$ | $32      $|
|$0.40$ | $0.428392$ | $0.428393$ | $128     $|
|$0.60$ | $0.603856$ | $0.603857$ | $128     $|
|$0.80$ | $0.742101$ | $0.742101$ | $256     $|
|$1.00$ | $0.842701$ | $0.842701$ | $256     $|
|$1.20$ | $0.910314$ | $0.910315$ | $256     $|
|$1.40$ | $0.952285$ | $0.952286$ | $256     $|
|$1.60$ | $0.976348$ | $0.976349$ | $256     $|
|$1.80$ | $0.989091$ | $0.989091$ | $256     $|
|$2.00$ | $0.995322$ | $0.995323$ | $128     $|
> Это уже гораздо быстрее! $n_{max}:~1'048'576 \to 256$
> 
> Если решить высчитывать в методе левых прямоугольников первый и последний отрезки при помощи
метода центральных прямоугольников, то, внезапно, несмотря на предположение, количество
разбиений вырастает до $8'388'608$

$\boxed{n_{max}=256}$

---

### Метод трапеций:

| $x$    | $J_0(x)$    | $J_n(x)$    | $n$       |
|:------:|:----------:|:----------:|:----------|
|$0.00$ | $0.000000$ | $0.000000$ | $1       $|
|$0.20$ | $0.222703$ | $0.222702$ | $64      $|
|$0.40$ | $0.428392$ | $0.428392$ | $128     $|
|$0.60$ | $0.603856$ | $0.603856$ | $256     $|
|$0.80$ | $0.742101$ | $0.742100$ | $256     $|
|$1.00$ | $0.842701$ | $0.842701$ | $512     $|
|$1.20$ | $0.910314$ | $0.910314$ | $512     $|
|$1.40$ | $0.952285$ | $0.952285$ | $512     $|
|$1.60$ | $0.976348$ | $0.976347$ | $256     $|
|$1.80$ | $0.989091$ | $0.989090$ | $256     $|
|$2.00$ | $0.995322$ | $0.995322$ | $256     $|

> Примечательно то, что тут максимальное число разбиений наблюдается в
середине отрезка $[a,b]=[0,2]$. Причем, невзирая на ожидаемый лучший чем метод центральных
интегралов результат, у последнего так же можно заметить подобную тенденцию. Однако, у
методов правых и левых прямоугольников такого нет $-$ у них по мере возрастания $x \in [a, b]$
возрастает и необходимое количество разбиений для обеспечения точности $10^{-6}$

$\boxed{n_{max}=512}$

---

### Метод Симпсона:

| $x$    | $J_0(x)$    | $J_n(x)$    | $n$       |
|:------:|:----------:|:----------:|:----------|
|$0.00$ | $0.000000$ | $0.000000$ | $1       $|
|$0.20$ | $0.222703$ | $0.222703$ | $2       $|
|$0.40$ | $0.428392$ | $0.428392$ | $4       $|
|$0.60$ | $0.603856$ | $0.603857$ | $4       $|
|$0.80$ | $0.742101$ | $0.742101$ | $8       $|
|$1.00$ | $0.842701$ | $0.842701$ | $8       $|
|$1.20$ | $0.910314$ | $0.910314$ | $4       $|
|$1.40$ | $0.952285$ | $0.952285$ | $8       $|
|$1.60$ | $0.976348$ | $0.976348$ | $8       $|
|$1.80$ | $0.989091$ | $0.989090$ | $16      $|
|$2.00$ | $0.995322$ | $0.995322$ | $16      $|

> А вот это уже серьезный результат. Невзирая на, казалось бы, сложность алгоритма:
высчитывание, по сути, интеграла сплайна из парабол, более сложная логика с лихвой
компенсируется многократно более быстрым подсчетом результата: $n_{max}: 256 \to 16$
(по сравнению с лучшим до этого методом центральных прямоугольников)

$\boxed{n_{max}=16}$

---

### Метод Гаусса:

| $x$    | $J_0(x)$    | $J_n(x)$    | $n$       |
|:------:|:----------:|:----------:|:----------|
|$0.00$ | $0.000000$ | $0.000000$ | $1       $|
|$0.20$ | $0.222703$ | $0.222702$ | $1       $|
|$0.40$ | $0.428392$ | $0.428392$ | $4       $|
|$0.60$ | $0.603856$ | $0.603856$ | $4       $|
|$0.80$ | $0.742101$ | $0.742101$ | $8       $|
|$1.00$ | $0.842701$ | $0.842701$ | $8       $|
|$1.20$ | $0.910314$ | $0.910314$ | $4       $|
|$1.40$ | $0.952285$ | $0.952285$ | $8       $|
|$1.60$ | $0.976348$ | $0.976349$ | $8       $|
|$1.80$ | $0.989091$ | $0.989091$ | $8       $|
|$2.00$ | $0.995322$ | $0.995323$ | $8       $|

> Заслуженно лучший метод. Не зря ему уделяется целая отдельная глава в пособии Даутова
Вычисления стали лишь немного более громоздкими, однако эффективность возросла в $2$ раза по
сравнению с методом Симпсона, и в целую $131'000$ раз на фоне метода левых прямоугольников

$\boxed{n_{max}=8}$
---

